<?php

/**
 * @file
 * Miscellaneous overrides for Freetibet site
 */

function ftoverrides_form_search_block_form_alter(&$form,&$form_state,$form_id) {

	$form['background'] = array(
		'#type' => 'markup',
		'#markup' => '<div class="icon-search"></div>'
	);
	$form['search_block_form']['#attributes']['placeholder'] = t('Search words');
	$form['actions']['submit']['#value'] = t('Go');
}

/*
 * implements hook_node_view
*/
function ftoverrides_node_view($node,$view_mode) {
	switch ($node->type) {
		case 'media_section':
			$mode = 'full';
			$items = field_get_items('node',$node,'field_layout_mode');
			if (!empty($items) && isset($items[0]) && isset($items[0]['value']) && is_string($items[0]['value'])) {
				$mode = $items[0]['value'];
			}
			if (!empty($items) && isset($items[0]) && isset($items[0]['value']) && is_string($items[0]['value'])) {
				$mode = $items[0]['value'];
			}
			
			$show_title = false;
			$items = field_get_items('node',$node,'field_show_title');
			if (!empty($items) && isset($items[0]) && isset($items[0]['value']) && is_numeric($items[0]['value'])) {
				$show_title = (bool) $items[0]['value'];
			}
			if ($mode != 'full' && empty($node->page_viewmode)) {
				$node->page_viewmode = $mode;
				$node->content = node_view($node,$mode);
			}
			if (!$show_title && isset($node->content['title'])) {
				unset($node->content['title']);
			}
			break;
	}
}

function ftoverrides_form_node_form_alter(&$form, $form_state, $form_id) {
	if (isset($form['node_class']) && isset($form['node_class']['css_class'])) {
      
			
			$form['node_class']['css_class']['#type'] = 'select';
			
			$arrClasses = array('' => "[none] ");
			
			$classes = array(
				'key-points-as-column',
				'full-width-section-images',
				'section-images-as-column'
			);
			
			$arrClasses += drupal_map_assoc($classes);
			
			$form['node_class']['css_class']['#options'] = $arrClasses;
			$form['node_class']['css_class']['#description'] = t("Class name will be added to wrapper tag of the node in full page view");
  }
}
